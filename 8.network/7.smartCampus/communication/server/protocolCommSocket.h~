#ifndef __PROTOCOL_COMM_SOCKET_H__
#define __PROTOCOL_COMM_SOCKET_H__

#include <tr1/memory>

#include "socket.h"
#include "commSocket.h"
#include "protocol.h"
#include "protocolMsg.h"

namespace netcpp
{

typedef std::tr1::shared_ptr<CommSocket> CommSocketPtr;
typedef std::tr1::shared_ptr<Protocol> ProtocolPtr;

class ProtocolCommSocket: public Socket
{
public:
	ProtocolCommSocket(CommSocketPtr _socket, ProtocolPtr _protocol);
	//virtual ~ProtocolCommSocket();
	
	void Disconnect();
	void Send(const ProtocolMsg& _msg, CommSocket::MsgFlag _flags = e_noFlag);
	ProtocolMsg Recv(CommSocket::MsgFlag _flags = e_noFlag);
	int GetId() const;

private:
	/* data */
	CommSocketPtr m_socket;
	ProtocolPtr m_protocol;
};

inline void ProtocolCommSocket::Disconnect()
{
	m_socket->Disconnect();
}

inline int ProtocolCommSocket::GetId() const
{
	m_socket->GetId();
}

}
#endif /* __PROTOCOL_COMM_SOCKET_H__ */

